# Техническое задание: Редактор топливных карт газобаллонного оборудования Zenit

## Общая информация

**Название проекта:** Zenit Map Editor  
**Версия:** 1.0.0  
**Технологический стек:** Electron, React, TypeScript, Vite, Tailwind CSS, Zustand, React Query, ESLint, Prettier  
**Целевая платформа:** Desktop (Windows, macOS, Linux)  
**Язык интерфейса:** Русский

## Описание проекта

Приложение для редактирования топливных карт газобаллонного оборудования Zenit JZ 2009. Позволяет загружать, просматривать и объединять топливные карты в формате \*.map, с возможностью выбора бензиновых и газовых карт для создания итогового файла.

## Функциональные требования

### 1. Главный экран

#### 1.1 Загрузка файлов

- **Выбор файлов:** Кнопка "Выбрать файлы" для открытия диалога выбора файлов
- **Drag & Drop:** Поддержка перетаскивания файлов \*.map в область приложения (всё окно приложения)
- **Поддержка множественного выбора:** Возможность загрузки нескольких файлов одновременно
- **Валидация файлов:** Проверка корректности формата \*.map
  - Проверка количества строк (должно быть 480 строк)
  - Проверка числового формата данных
  - Проверка диапазона значений (давление: 0-2000 мбар, время впрыска: 0-50 мс)

#### 1.2 Отображение топливных карт

- **Визуализация карт:** Графическое отображение топливных точек на координатной сетке
  - **Ось X:** Давление в коллекторе (мбар) - горизонтальная ось
  - **Ось Y:** Время впрыска (мс) - вертикальная ось
  - **Бензиновые точки:** **синий цвет** (#0066CC)
  - **Газовые точки:** **желтый цвет** (#FFD700)
  - **Масштабирование:** Автоматическое масштабирование для отображения всех 120 точек
  - **Сетка координат:** Отображение осей с подписями и делениями
- **Активный файл:** Полная непрозрачность (opacity: 1.0)
- **Неактивные файлы:** Прозрачность 50% (opacity: 0.5)
- **Переключение активного файла:** Клик по карте для активации
- **Включение/отключение файлов:** Чекбокс для каждого загруженного файла
  - **Включенный файл:** Отображается на экране с соответствующей прозрачностью
  - **Отключенный файл:** Скрыт с экрана (display: none)
  - **Массовое управление:** Кнопки "Включить все" / "Отключить все"
  - **Сохранение состояния:** Запоминание выбора включенных файлов при переключении активной
- **Включение/отключение отдельных карт:** Чекбоксы для бензиновых и газовых карт
  - **Бензиновые карты:** Чекбокс для управления видимостью синих точек
  - **Газовые карты:** Чекбокс для управления видимостью желтых точек
  - **Независимое управление:** Каждая карта может быть включена/отключена отдельно
  - **Сохранение состояния:** Запоминание видимости каждой карты при переключении файлов

#### 1.3 Выбор карт для объединения

- **Структура файлов:** Каждый файл \*.map содержит двойную карту (бензин + газ)
- **Интегрированный выбор:** Радио-кнопки встроены в список загруженных файлов
- **Выбор бензиновой карты:** Радио-кнопка "○ Выбрать" для бензиновой части файла
- **Выбор газовой карты:** Радио-кнопка "○ Выбрать" для газовой части файла
- **Ограничения:** Можно выбрать только одну бензиновую И одну газовую карту (из разных или одного файла)
- **Визуальная индикация:** Выделение выбранных карт в списке файлов
- **Вертикальная прокрутка:** Список файлов с прокруткой при большом количестве

### 2. Сохранение результата

#### 2.1 Кнопка сохранения

- **Кнопка "Сохранить":** Создание итогового файла
- **Имя файла по умчанию:** "${бензиновая карта}M.map"
- **Диалог сохранения:** Возможность изменить имя и путь сохранения
- **Формат файла:** \*.map

## Технические требования

### 1. Архитектура приложения

#### 1.1 Electron + React структура

```
src/
├── main/                # Главный процесс Electron
│   ├── main.ts          # Главный процесс
│   ├── preload.ts       # Preload скрипт
│   └── ipc/             # IPC обработчики
│       ├── fileHandlers.ts
│       └── windowHandlers.ts
├── renderer/            # React приложение
│   ├── index.html       # Главная страница
│   ├── main.tsx         # Точка входа React
│   ├── App.tsx          # Главный компонент
│   ├── components/      # React компоненты
│   │   ├── ui/          # UI компоненты
│   │   ├── FileManager/ # Управление файлами
│   │   ├── MapViewer/   # Просмотр карт
│   │   └── ControlPanel/ # Панель управления
│   ├── hooks/           # React хуки
│   ├── services/        # Сервисы
│   │   ├── fileService.ts
│   │   ├── mapService.ts
│   │   └── electronService.ts
│   ├── store/           # Zustand store
│   │   ├── fileStore.ts
│   │   ├── mapStore.ts
│   │   └── uiStore.ts
│   ├── types/           # TypeScript типы
│   └── utils/           # Утилиты
├── shared/              # Общий код
│   ├── types/           # Общие типы
│   └── constants/       # Константы
└── assets/              # Ресурсы
    ├── icons/           # Иконки приложения
    └── styles/          # Глобальные стили
```

#### 1.2 Основные модули

**React компоненты:**

- **FileManager:** Управление загрузкой и отображением файлов
- **MapViewer:** Canvas компонент для визуализации карт
- **ControlPanel:** Панель управления видимостью и выбором карт
- **UI Components:** Переиспользуемые UI компоненты

**Сервисы:**

- **FileService:** Парсинг и валидация файлов \*.map
- **MapService:** Обработка данных карт и объединение
- **ElectronService:** IPC взаимодействие с главным процессом

**Управление состоянием:**

- **Zustand Store:** Централизованное управление состоянием
- **React Query:** Кэширование и синхронизация данных
- **TypeScript:** Типизация всех данных и API

### 2. Формат файлов \*.map

#### 2.1 Структура данных

Файлы \*.map содержат топливные карты в текстовом формате с разделителями `\r\n`. Каждая карта состоит из 120 точек данных (480 строк), где каждая точка представлена двумя значениями:

```javascript
// Структура файла *.map
// Каждая строка содержит одно числовое значение
// Формат: X_бенз1, Y_бенз1, X_газ1, Y_газ1, X_бенз2, Y_бенз2, X_газ2, Y_газ2, ... (120 точек = 480 значений)

// Пример данных из 31102018.map:
// 320    <- X_бенз1 (Давление в коллекторе, мбар)
// 4,4    <- Y_бенз1 (Время впрыска, мс)
// 560    <- X_газ1 (Давление в коллекторе, мбар)
// 12     <- Y_газ1 (Время впрыска, мс)
// 320    <- X_бенз2 (Давление в коллекторе, мбар)
// 4,4    <- Y_бенз2 (Время впрыска, мс)
// 860    <- X_газ2 (Давление в коллекторе, мбар)
// 15,6   <- Y_газ2 (Время впрыска, мс)
// ...    <- 120 точек данных (480 строк)

// Структура для обработки в приложении:
{
  fileName: string,           // Название файла (например, "31102018.map")
  petrolMap: {               // Бензиновая карта (строки 0,1,4,5,8,9...)
    points: [                // Массив из 120 топливных точек
      {
        x: number,           // Давление в коллекторе (мбар)
        y: number,           // Время впрыска (мс)
        index: number        // Индекс точки (0-119)
      }
    ]
  },
  gasMap: {                  // Газовая карта (строки 2,3,6,7,10,11...)
    points: [                // Массив из 120 топливных точек
      {
        x: number,           // Давление в коллекторе (мбар)
        y: number,           // Время впрыска (мс)
        index: number        // Индекс точки (0-119)
      }
    ]
  },
  rawData: string[],         // Исходные данные файла (480 строк)
  totalPoints: 240           // Общее количество точек (120 бензин + 120 газ)
}
```

#### 2.2 Объединение карт

При объединении бензиновой и газовой карт используется алгоритм из `mergeMaps.js`:

```javascript
// Алгоритм объединения для двойных карт:
// - Берется бензиновая карта из выбранного файла (строки 0,1,4,5,8,9...)
// - Берется газовая карта из выбранного файла (строки 2,3,6,7,10,11...)
// - Создается новая карта: [X1_бенз, Y1_бенз, X1_газ, Y1_газ, X2_бенз, Y2_бенз, X2_газ, Y2_газ, ...]
// - Итоговый файл содержит 480 строк (120 точек × 4 значения)

const mergedMap = [];
for (let i = 0; i < 120; i++) {
  const offset = i * 4;
  mergedMap.push(petrolMap[offset]); // X бензин (строка 0,4,8,12...)
  mergedMap.push(petrolMap[offset + 1]); // Y бензин (строка 1,5,9,13...)
  mergedMap.push(gasMap[offset + 2]); // X газ (строка 2,6,10,14...)
  mergedMap.push(gasMap[offset + 3]); // Y газ (строка 3,7,11,15...)
}
```

### 3. Пользовательский интерфейс

#### 3.1 Макет главного экрана

**Двухколоночный макет:**

- **Левая колонка (flex):** Область отображения графика с Canvas
- **Правая колонка (200px):** Панель управления с загруженными картами

**Особенности макета:**

- **Адаптивность:** Возможность изменения пропорций колонок
- **Вертикальная прокрутка:** Список карт с прокруткой при большом количестве файлов
- **Интегрированный интерфейс:** Все элементы управления в правой панели
- **Полноэкранный график:** Максимальное использование пространства для визуализации

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ Zenit Map Editor                                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────┐ ┌─────────────────────────────────────────┐ │
│ │                             │ │ [Выбрать файлы]                         │ │
│ │                             │ ├─────────────────────────────────────────┤ │
│ │        ГРАФИК               │ │ Загруженные файлы:                      │ │
│ │     (Canvas область)        │ │ [Включить все] [Отключить все]          │ │
│ │                             │ │                                         │ │
│ │  ┌─────────────────────┐    │ │ ┌─────────────────────────────────────┐ │ │
│ │  │                     │    │ │ │ ☑ 31102018.map                      │ │ │
│ │  │   Топливные точки   │    │ │ │   ┌─ ☑ Бензин: ○                    │ │ │
│ │  │   • • • • • • •     │    │ │ │   └─ ☑ Газ: ○                       │ │ │
│ │  │   • • • • • • •     │    │ │ │                                     │ │ │
│ │  │   • • • • • • •     │    │ │ │ ☑ 15112018.map                      │ │ │
│ │  │   • • • • • • •     │    │ │ │   ┌─ ☑ Бензин: ○                    │ │ │
│ │  │                     │    │ │ │   └─ ☑ Газ: ○                       │ │ │
│ │  └─────────────────────┘    │ │ │                                     │ │ │
│ │                             │ │ │ ☐ 20122018.map                      │ │ │
│ │  X: Давление (мбар)         │ │ │   ┌─ ☑ Бензин: ○                    │ │ │
│ │  Y: Время впрыска (мс)      │ │ │   └─ ☑ Газ: ○                       │ │ │
│ │                             │ │ │                                     │ │ │
│ │                             │ │ │ ☐ 05012019.map                      │ │ │
│ │                             │ │ │   ┌─ ☑ Бензин: ○                    │ │ │
│ │                             │ │ │   └─ ☑ Газ: ○                       │ │ │
│ │                             │ │ │                                     │ │ │
│ │                             │ │ │ ...                                 │ │ │
│ │                             │ │ └─────────────────────────────────────┘ │ │
│ │                             │ │                                         │ │
│ │                             │ │ [Сохранить] Имя: [бензиновая карта.map] │ │
│ │                             │ │                                         │ │
│ └─────────────────────────────┘ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 3.2 Стили и цвета (Tailwind CSS)

**Цветовая палитра:**

- **Основной:** `slate-800` (темно-серый)
- **Акцентный:** `blue-600` (синий)
- **Бензиновые точки:** `blue-600` (синий)
- **Газовые точки:** `yellow-500` (желтый)
- **Фон:** `gray-50` (светло-серый)
- **Текст:** `slate-800` (темно-серый)
- **Успех:** `green-600` (зеленый)
- **Ошибка:** `red-600` (красный)
- **Предупреждение:** `orange-500` (оранжевый)

**Компоненты UI:**

- **Кнопки:** Использование Tailwind компонентов с hover/focus состояниями
- **Формы:** Стилизованные input, checkbox, radio элементы
- **Модальные окна:** Overlay с backdrop-blur эффектами
- **Анимации:** Transition и transform эффекты
- **Адаптивность:** Responsive дизайн с breakpoints

### 4. Функциональные модули

#### 4.1 File Service (fileService.ts)

```typescript
interface MapPoint {
  x: number; // Давление в коллекторе (мбар)
  y: number; // Время впрыска (мс)
  index: number; // Индекс точки (0-119)
}

interface MapData {
  points: MapPoint[];
  visible: boolean;
}

interface FileData {
  fileName: string;
  filePath: string;
  petrolMap: MapData;
  gasMap: MapData;
  rawData: string[];
  totalPoints: number;
  fileVisible: boolean;
  loadedAt: Date;
}

class FileService {
  // Загрузка и парсинг файлов *.map
  async loadMapFile(
    filePath: string,
    fileName: string,
    rawData: string
  ): Promise<FileData>;

  // Парсинг данных из формата \r\n в двойную карту
  parseMapData(rawData: string, fileName: string): FileData;

  // Валидация формата файла (проверка на 480 строк)
  validateMapFile(rawData: string): ValidationResult;

  // Извлечение бензиновой карты (строки 0,1,4,5,8,9...)
  extractPetrolMap(values: number[]): MapPoint[];

  // Извлечение газовой карты (строки 2,3,6,7,10,11...)
  extractGasMap(values: number[]): MapPoint[];

  // Создание объединенной карты из выбранных бензиновой и газовой карт
  mergeMaps(petrolPoints: MapPoint[], gasPoints: MapPoint[]): number[];

  // Форматирование данных для сохранения в файл
  formatDataForSave(mergedData: number[]): string;

  // Генерация имени файла по умолчанию
  generateDefaultFileName(petrolFileName: string): string;
}
```

#### 4.2 Map Service (mapService.ts)

```typescript
interface CoordinateSystem {
  x: { min: number; max: number };
  y: { min: number; max: number };
}

interface RenderConfig {
  canvasWidth: number;
  canvasHeight: number;
  margin: number;
  pointSize: number;
  colors: {
    petrol: string;
    gas: string;
    grid: string;
    axes: string;
  };
}

class MapService {
  // Инициализация Canvas с координатной системой
  initCanvas(canvasRef: React.RefObject<HTMLCanvasElement>): void;

  // Настройка координатной сетки
  setupCoordinateSystem(config: RenderConfig): CoordinateSystem;

  // Рендеринг координатных осей
  renderAxes(ctx: CanvasRenderingContext2D, config: RenderConfig): void;

  // Рендеринг топливных точек карты
  renderMap(
    ctx: CanvasRenderingContext2D,
    mapData: FileData,
    config: RenderConfig,
    isActive: boolean
  ): void;

  // Масштабирование для отображения всех точек
  calculateScale(points: MapPoint[], config: RenderConfig): CoordinateSystem;

  // Преобразование координат в пиксели
  pointToPixel(
    x: number,
    y: number,
    config: RenderConfig
  ): { x: number; y: number };

  // Обработка кликов по карте
  handleCanvasClick(event: MouseEvent, config: RenderConfig): void;

  // Обновление диапазона данных на основе загруженных карт
  updateDataRange(maps: FileData[]): CoordinateSystem;

  // Основной метод рендеринга
  render(
    canvasRef: React.RefObject<HTMLCanvasElement>,
    visibleMaps: FileData[],
    activeFile: string | null
  ): void;
}
```

#### 4.3 Zustand Store (store/)

```typescript
// fileStore.ts
interface FileStore {
  files: Map<string, FileData>;
  activeFile: string | null;
  visibleFiles: Set<string>;

  // Actions
  addFile: (fileName: string, fileData: FileData) => void;
  removeFile: (fileName: string) => void;
  setActiveFile: (fileName: string | null) => void;
  toggleFileVisibility: (fileName: string) => void;
  setAllFilesVisible: (visible: boolean) => void;
  clearAllFiles: () => void;
}

// mapStore.ts
interface MapStore {
  selectedPetrolMap: MapSelection | null;
  selectedGasMap: MapSelection | null;
  visibleMaps: Map<string, MapVisibility>;

  // Actions
  selectMapForMerge: (fileName: string, mapType: "petrol" | "gas") => void;
  toggleMapVisibility: (fileName: string, mapType: "petrol" | "gas") => void;
  setAllMapsVisible: (mapType: "petrol" | "gas", visible: boolean) => void;
  clearSelection: () => void;
}

// uiStore.ts
interface UIStore {
  isLoading: boolean;
  statusMessage: string;
  error: string | null;

  // Actions
  setLoading: (loading: boolean) => void;
  setStatus: (message: string) => void;
  setError: (error: string | null) => void;
  clearError: () => void;
}

// Комбинированный store
interface AppStore extends FileStore, MapStore, UIStore {
  // Computed values
  isReadyToSave: () => boolean;
  getVisibleMapsForRenderer: () => FileData[];
  getStats: () => AppStats;
}
```

## Нефункциональные требования

### 1. Производительность

- **Время загрузки:** < 3 секунд для файлов до 10MB
- **Отзывчивость UI:** < 100ms для переключения между картами
- **Память:** < 500MB для работы с 50+ картами

### 2. Совместимость

- **Windows:** 10, 11
- **macOS:** 10.15+
- **Linux:** Ubuntu 18.04+, CentOS 7+

### 3. Безопасность

- **Валидация файлов:** Проверка формата и размера
- **Изоляция:** Sandbox режим Electron
- **Обработка ошибок:** Graceful handling всех исключений

## Структура проекта

### Файловая структура

```
zenit-map-editor/
├── package.json                    # Конфигурация проекта и зависимости
├── package-lock.json              # Заблокированные версии зависимостей
├── .gitignore                     # Исключения для Git
├── .eslintrc.js                   # Конфигурация ESLint
├── .prettierrc                    # Конфигурация Prettier
├── tailwind.config.js             # Конфигурация Tailwind CSS
├── vite.config.ts                 # Конфигурация Vite
├── tsconfig.json                  # Конфигурация TypeScript
├── electron-builder.json          # Конфигурация сборки
├── README.md                      # Документация проекта
├── LICENSE                        # Лицензия MIT
├── src/                          # Исходный код приложения
│   ├── main/                     # Главный процесс Electron
│   │   ├── main.ts               # Главный процесс
│   │   ├── preload.ts            # Preload скрипт
│   │   └── ipc/                  # IPC обработчики
│   │       ├── fileHandlers.ts   # Обработка файловых операций
│   │       └── windowHandlers.ts # Обработка окон
│   ├── renderer/                 # React приложение
│   │   ├── index.html            # Главная страница
│   │   ├── main.tsx              # Точка входа React
│   │   ├── App.tsx               # Главный компонент
│   │   ├── components/           # React компоненты
│   │   │   ├── ui/               # UI компоненты
│   │   │   │   ├── Button.tsx
│   │   │   │   ├── Checkbox.tsx
│   │   │   │   ├── Modal.tsx
│   │   │   │   └── index.ts
│   │   │   ├── FileManager/      # Управление файлами
│   │   │   │   ├── FileList.tsx
│   │   │   │   ├── FileItem.tsx
│   │   │   │   └── DragDropArea.tsx
│   │   │   ├── MapViewer/        # Просмотр карт
│   │   │   │   ├── MapCanvas.tsx
│   │   │   │   └── CoordinateSystem.tsx
│   │   │   └── ControlPanel/     # Панель управления
│   │   │       ├── VisibilityControls.tsx
│   │   │       ├── MapSelection.tsx
│   │   │       └── SaveControls.tsx
│   │   ├── hooks/                # React хуки
│   │   │   ├── useFileUpload.ts
│   │   │   ├── useMapRenderer.ts
│   │   │   └── useElectronAPI.ts
│   │   ├── services/             # Сервисы
│   │   │   ├── fileService.ts    # Обработка файлов *.map
│   │   │   ├── mapService.ts     # Обработка карт
│   │   │   └── electronService.ts # IPC взаимодействие
│   │   ├── store/                # Zustand store
│   │   │   ├── fileStore.ts      # Состояние файлов
│   │   │   ├── mapStore.ts       # Состояние карт
│   │   │   ├── uiStore.ts        # UI состояние
│   │   │   └── index.ts          # Комбинированный store
│   │   ├── types/                # TypeScript типы
│   │   │   ├── file.ts
│   │   │   ├── map.ts
│   │   │   └── index.ts
│   │   └── utils/                # Утилиты
│   │       ├── validation.ts
│   │       └── constants.ts
│   └── shared/                   # Общий код
│       ├── types/                # Общие типы
│       └── constants/            # Константы
├── assets/                       # Ресурсы приложения
│   ├── icons/                    # Иконки приложения
│   │   ├── icon.svg              # SVG иконка
│   │   ├── icon.png              # PNG иконка
│   │   └── icon.ico              # ICO иконка (Windows)
│   └── styles/                   # Глобальные стили
│       └── globals.css           # Tailwind CSS
├── dist/                         # Собранное приложение
└── tech_spec/                    # Техническая документация
    ├── TECHNICAL_SPECIFICATION.md # Техническое задание
    ├── 11072017-gasoline.map     # Пример файла карты
    └── 31102018.map              # Пример файла карты
```

### Основные компоненты

#### 1. Главный процесс (main.ts)

- Инициализация Electron приложения с TypeScript
- Создание главного окна с настройками безопасности
- Обработка IPC сообщений для файловых операций
- Диалоги выбора и сохранения файлов
- Управление жизненным циклом приложения

#### 2. Preload скрипт (preload.ts)

- Безопасное взаимодействие между процессами
- Предоставление типизированного API для renderer процесса
- Изоляция контекста с contextBridge
- Валидация IPC сообщений

#### 3. React приложение

- **main.tsx**: Точка входа с React 18 и StrictMode
- **App.tsx**: Главный компонент с роутингом
- **components/**: Модульные React компоненты
- **hooks/**: Кастомные React хуки
- **services/**: Бизнес-логика и API взаимодействие

#### 4. Управление состоянием

- **Zustand**: Легковесное управление состоянием
- **React Query**: Кэширование и синхронизация данных
- **TypeScript**: Полная типизация всех состояний

#### 5. Стилизация

- **Tailwind CSS**: Utility-first CSS фреймворк
- **Responsive дизайн**: Адаптивность для разных размеров экрана
- **Темная тема**: Поддержка темной темы (опционально)

## План разработки

### Этап 1: Базовая структура (1-2 недели)

- [ ] Настройка Electron + React + TypeScript проекта
- [ ] Конфигурация Vite, Tailwind CSS, ESLint, Prettier
- [ ] Создание базовой структуры папок и файлов
- [ ] Настройка главного процесса Electron с TypeScript
- [ ] Создание preload скрипта с типизированным API
- [ ] Базовая React структура с компонентами
- [ ] Настройка Zustand store для управления состоянием

### Этап 2: UI компоненты и сервисы (2-3 недели)

- [ ] Создание базовых UI компонентов (Button, Checkbox, Modal)
- [ ] Реализация FileManager компонентов (FileList, FileItem, DragDropArea)
- [ ] Создание MapViewer компонента с Canvas
- [ ] Реализация ControlPanel компонентов
- [ ] Настройка React Query для кэширования данных
- [ ] Создание кастомных хуков (useFileUpload, useMapRenderer)
- [ ] Интеграция с Electron API через типизированный сервис

### Этап 3: Бизнес-логика и обработка данных (1-2 недели)

- [ ] Реализация FileService для парсинга .map файлов
- [ ] Создание MapService для обработки карт
- [ ] Валидация файлов с TypeScript типами
- [ ] Алгоритм объединения карт
- [ ] Система выбора карт для объединения
- [ ] Визуальная индикация выбранных карт
- [ ] Экспорт объединенных файлов

### Этап 4: Тестирование и полировка (1-2 недели)

- [ ] Unit тесты с Jest и React Testing Library
- [ ] Интеграционные тесты для Electron
- [ ] E2E тесты с Playwright
- [ ] Оптимизация производительности
- [ ] UI/UX улучшения с Tailwind CSS
- [ ] Документация и примеры использования
- [ ] Сборка для всех платформ

## Современный технологический стек

### Преимущества нового стека

**TypeScript:**

- Статическая типизация для предотвращения ошибок
- Лучшая поддержка IDE с автодополнением
- Рефакторинг и поддержка кода

**React 18:**

- Современные хуки и функциональные компоненты
- Concurrent Features для лучшей производительности
- StrictMode для выявления проблем

**Vite:**

- Мгновенная горячая перезагрузка (HMR)
- Быстрая сборка с esbuild
- Оптимизация для разработки

**Tailwind CSS:**

- Utility-first подход для быстрой стилизации
- Responsive дизайн из коробки
- Консистентная дизайн-система

**Zustand:**

- Простое и легковесное управление состоянием
- TypeScript поддержка
- Минимальный boilerplate код

**React Query:**

- Кэширование и синхронизация данных
- Оптимистичные обновления
- Автоматическая обработка загрузки и ошибок

### Инструменты разработки

- **ESLint + Prettier:** Качество и форматирование кода
- **Husky + lint-staged:** Pre-commit хуки
- **Jest + React Testing Library:** Тестирование
- **Playwright:** E2E тестирование
- **Electron Builder:** Сборка приложения

## Текущий статус проекта

### 🔄 В процессе (Этап 1)

**Обновление технологического стека:**

- 🔄 Миграция на Electron + React + TypeScript
- 🔄 Настройка Vite для быстрой разработки
- 🔄 Интеграция Tailwind CSS для стилизации
- 🔄 Настройка Zustand для управления состоянием
- 🔄 Конфигурация ESLint и Prettier
- 🔄 Создание типизированного API для Electron

**Планируется:**

- 📋 Создание React компонентов
- 📋 Реализация сервисов с TypeScript
- 📋 Настройка тестирования
- 📋 Оптимизация производительности

### 🔄 В процессе

**Тестирование:**

- 🔄 Тестирование с реальными файлами
- 🔄 Проверка производительности
- 🔄 Валидация пользовательского интерфейса

### 📋 Планируется

**Дополнительные возможности:**

- 📋 Предварительный просмотр объединенной карты
- 📋 Настройки цветов и прозрачности
- 📋 Экспорт в различные форматы
- 📋 Редактирование топливных точек
- 📋 Сравнение карт

## Критерии приемки

### 1. Функциональные критерии

- ✅ Загрузка множественных файлов \*.map
- ✅ Drag & Drop поддержка
- ✅ Визуализация бензиновых (синий) и газовых (желтый) точек на координатной сетке
- ✅ Отображение осей: X (давление в коллекторе, мбар) и Y (время впрыска, мс)
- ✅ Автоматическое масштабирование для отображения всех 120 точек
- ✅ Переключение активной карты
- ✅ Включение/отключение отображения файлов (чекбоксы)
- ✅ Включение/отключение отдельных карт (чекбоксы для бензин/газ)
- ✅ Независимое управление видимостью бензиновых и газовых карт
- ✅ Массовое управление видимостью ("Включить все" / "Отключить все")
- ✅ Двухколоночный макет (график слева, управление справа)
- ✅ Вертикальное расположение списка загруженных файлов
- ✅ Отображение двойных карт (бензин + газ) в каждом файле
- ✅ Интегрированный выбор карт для объединения в списке файлов
- ✅ Выбор одной бензиновой и одной газовой карты (из разных или одного файла)
- ✅ Сохранение с именем по умолчанию "${выбранная бензиновая карта}M.map"

### 2. Технические критерии

- ✅ Стабильная работа на всех целевых платформах
- ✅ Обработка ошибок и некорректных файлов
- ✅ Производительность согласно требованиям
- ✅ Чистый и поддерживаемый код

## Дополнительные возможности (будущие версии)

### v1.1

- Предварительный просмотр объединенной карты
- Настройки цветов и прозрачности
- Экспорт в различные форматы

### v1.2

- Редактирование топливных точек
- Создание новых карт
- История изменений

### v1.3

- Сравнение карт
- Статистика по топливным точкам
- Пакетная обработка файлов

---

**Дата создания:** $(date)  
**Версия документа:** 1.0  
**Автор:** Yury Marmysh
